--Hebbal--
package practice;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.List;
import java.util.Set;
import java.util.concurrent.TimeUnit;

import org.apache.commons.io.FileUtils;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.Select;
import org.testng.Assert;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Parameters;
import org.testng.annotations.Test;

public class IVS_QP4 {

    WebDriver driver;

    @BeforeClass
    public void setup() {
        System.setProperty("", "");
        driver = new FirefoxDriver();
        driver.get("");
        driver.manage().window().maximize();
        driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
    }

    @AfterClass
    public void teardown() {
        driver.close();
    }

    @Test(priority = -3)
    @Parameters({ "emailid", "password" })
    public void loginTest(String emailid, String password) {

        driver.findElement(By.id("")).sendKeys(emailid);
        driver.findElement(By.id("")).sendKeys(password);
        driver.findElement(By.id("")).click();
    }

    @Test(priority = -2, dataProvider = "data")
    public void dropDown(String val1) throws IOException {

        Set<String> window = driver.getWindowHandles();
        for (String win : window) {
            driver.switchTo().window(win);
            String url = driver.getCurrentUrl();
            if (url.equals("")) {
                System.out.println("what the");
                break;
            }
        }

        Select s = new Select(driver.findElement(By.id("")));
        s.selectByVisibleText(val1);

        File src = ((TakesScreenshot) driver).getScreenshotAs(OutputType.FILE);
        FileUtils.copyFile(src, new File("/image.png"));
    }

    @DataProvider(name = "data")
    public Object[][] data() {

        Object[][] dt = new Object[2][1];
        dt[0][0] = "Dev Urs Road";
        dt[1][0] = "Hebbal";
        return dt;
    }

    @Test(priority = -1)
    public void addItem() throws IOException {

        FileInputStream fis = new FileInputStream("");
        XSSFWorkbook wb = new XSSFWorkbook(fis);
        XSSFSheet sheet = wb.getSheet("");

        for (int i = 1; i <= sheet.getLastRowNum(); i++) {

            String first = sheet.getRow(i).getCell(0).getStringCellValue();
            int first1 = (int) sheet.getRow(i).getCell(1).getNumericCellValue();
            long first2 = (long) sheet.getRow(i).getCell(2).getNumericCellValue();

            driver.findElement(By.id("")).sendKeys(first);

            Select sr = new Select(driver.findElement(By.id("")));
            sr.selectByVisibleText(String.valueOf(first1));

            driver.findElement(By.id("")).sendKeys(String.valueOf(first2));
            driver.findElement(By.id("")).click(); // add item button

            String msg = driver.findElement(By.id("")).getText();
            System.out.println(msg);

            driver.findElement(By.id("")).click(); // calculate total Bill button
        }

        FileOutputStream fos = new FileOutputStream("");
        wb.write(fos);
        wb.close();

        String ma = driver.switchTo().alert().getText();
        Assert.assertEquals(120, Integer.parseInt(ma));
        driver.switchTo().alert().accept();

        Set<String> window = driver.getWindowHandles();
        for (String win : window) {
            driver.switchTo().window(win);
            String url = driver.getCurrentUrl();
            if (url.equals("")) {
                System.out.println("sdgegn");
                break;
            }
        }
    }

    @Test(priority = 0)
    public void WebTable() {

        WebElement table = driver.findElement(By.id(""));
        List<WebElement> rows = table.findElements(By.tagName("tr"));

        for (int i = 0; i < rows.size(); i++) {

            List<WebElement> cols = rows.get(i).findElements(By.tagName("td"));
            if (cols.get(2).getText().equals("potato")) {
                int price = Integer.parseInt(cols.get(1).getText());
                Assert.assertEquals(20, price);
            }
        }
    }
}