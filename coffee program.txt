--coffee---
package practice;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.List;
import java.util.concurrent.TimeUnit;

import org.apache.commons.io.FileUtils;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.Select;
import org.testng.Assert;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Parameters;
import org.testng.annotations.Test;

public class IVS_QP3 {

    WebDriver driver;

    @BeforeClass
    @Parameters({ "url" })
    public void setup(String url) {
        System.setProperty("webdriver.gecko.driver", "./home/user/Desktop/geckodriver");
        driver = new FirefoxDriver();
        driver.get(""); // url
        driver.manage().window().maximize();
        driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);
    }

    @AfterMethod
    public void teardown() {
        driver.close();
    }

    @Test(priority = 8)
    public void test001() throws IOException {

        driver.findElement(By.id("")).click(); // click on radio button

        Select s = new Select(driver.findElement(By.id("")));
        s.selectByVisibleText("Bengaluru");

        Select st = new Select(driver.findElement(By.id("")));
        st.selectByVisibleText("BTM 2nd stage 31st main");

        driver.findElement(By.id("")).click(); // BuildOrder
        driver.findElement(By.id("")).sendKeys("8887775553");
        driver.findElement(By.id("")).click(); // tea button

        FileInputStream fis = new FileInputStream("");
        XSSFWorkbook wb = new XSSFWorkbook(fis);
        XSSFSheet sheet = wb.getSheet("");

        for (int i = 1; i <= sheet.getLastRowNum(); i++) {

            String first = sheet.getRow(i).getCell(0).getStringCellValue();
            int first1 = (int) sheet.getRow(i).getCell(1).getNumericCellValue();
            long first2 = (long) sheet.getRow(i).getCell(2).getNumericCellValue();

            driver.findElement(By.id("")).sendKeys(first);

            Select sr = new Select(driver.findElement(By.id("")));
            sr.selectByVisibleText(String.valueOf(first1));

            driver.findElement(By.id("")).sendKeys(String.valueOf(first2));
            driver.findElement(By.id("")).click(); // place order button

            String msg = driver.switchTo().alert().getText();
            driver.switchTo().alert().accept();
            System.out.println("Amount Payable is: " + msg);

            driver.findElement(By.id("")).click(); // for reset
            sheet.getRow(i).createCell(3).setCellValue(msg);

            Assert.assertEquals(350, msg);
        }

        FileOutputStream fos = new FileOutputStream("");
        wb.write(fos);
        wb.close();

        WebElement table = driver.findElement(By.id(""));
        List<WebElement> rows = table.findElements(By.tagName("tr"));
        System.out.println(rows.size());

        for (int i = 0; i < rows.size(); i++) {

            List<WebElement> cols = rows.get(i).findElements(By.tagName("td"));
            if (cols.get(3).getText().equals("10 RS")) {
                System.out.println(cols.get(2).getText());
            }
        }
    }

    @Test(priority = 7, dataProvider = "data")
    public void test002(String val1, String val2, String val3) throws IOException {

        driver.findElement(By.id("")).click(); // clicking radio button for pick up

        Select sc = new Select(driver.findElement(By.id("")));
        sc.selectByVisibleText("Mysuru");

        Select sl = new Select(driver.findElement(By.id("")));
        sl.selectByVisibleText("TempleRoad");

        driver.findElement(By.id("")).sendKeys("2221110000");
        driver.findElement(By.id("")).click(); // for coffee radio button

        driver.findElement(By.id("")).clear();
        driver.findElement(By.id("")).sendKeys(val1);

        driver.findElement(By.id("")).clear();
        driver.findElement(By.id("")).sendKeys(val2);

        driver.findElement(By.id("")).clear();
        driver.findElement(By.id("")).sendKeys(val3);

        driver.findElement(By.id("")).click();

        String mes = driver.findElement(By.id("")).getText();
        System.out.println("Amount Payable is: " + mes);

        File src = ((TakesScreenshot) driver).getScreenshotAs(OutputType.FILE);
        FileUtils.copyFile(src, new File("" + "screenshot" + val1 + "" + val2 + "" + val3 + ".png"));

        driver.findElement(By.id("")).click(); // place order button

        String mar = driver.findElement(By.id("")).getText(); // order confirmation message
        System.out.println(mar);

        driver.get("pageurl");
    }

    @DataProvider(name = "data")
    public Object[][] data() {

        Object[][] dt = new Object[3][3];

        dt[0][0] = "Black coffee";
        dt[0][1] = "Large";
        dt[0][2] = "11";

        dt[1][0] = "Cappuccino";
        dt[1][1] = "Small";
        dt[1][2] = "12";

        dt[2][0] = "Espresso";
        dt[2][1] = "Large";
        dt[2][2] = "9";

        return dt;
    }
}