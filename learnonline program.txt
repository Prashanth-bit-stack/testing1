--learnonline--
package practice;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.List;
import java.util.concurrent.TimeUnit;

import org.apache.commons.io.FileUtils;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.Select;
import org.testng.Assert;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Parameters;
import org.testng.annotations.Test;

public class IVS_QP5 {

    WebDriver driver;

    @BeforeClass
    @Parameters({ "url", "times" })
    public void setup(String url, long times) {
        System.setProperty(null, null);
        driver = new FirefoxDriver();
        driver.get(url);
        driver.manage().window().maximize();
        driver.manage().timeouts().implicitlyWait(times, TimeUnit.SECONDS);
    }

    @AfterClass
    public void teardown() {
        driver.close();
        driver.quit();
    }

    @Test(priority = 0)
    public void about() throws IOException {
        driver.findElement(By.id("")).click(); // click on about link
        File src = ((TakesScreenshot) driver).getScreenshotAs(OutputType.FILE);
        FileUtils.copyFile(src, new File("path of the location/image.png"));
    }

    @Test(priority = 1)
    public void offers() {
        driver.findElement(By.id("")).click(); // click on offers link
        WebElement table = driver.findElement(By.id(""));
        List<WebElement> rows = table.findElements(By.tagName("tr"));
        System.out.println(rows.size());

        for (int i = 0; i < rows.size(); i++) {
            List<WebElement> cols = rows.get(i).findElements(By.tagName("td"));
            if (cols.get(1).getText().equals("L0150")) {
                System.out.println(cols.get(0).getText());
                Assert.assertEquals(cols.get(0).getText(), 15);
            }
        }
    }

    @Test(priority = 2)
    public void enroll() throws IOException {

        driver.findElement(By.id("")).click(); // click on Home link
        String w = driver.getTitle(); // title
        Assert.assertEquals(w, "Learn Online");

        driver.findElement(By.id("")).click(); // for Scroll down
        driver.findElement(By.id("")).click(); // click on view under the course

        Select s = new Select(driver.findElement(By.id("")));
        s.selectByVisibleText("Intro to programming in Python");

        String info = driver.findElement(By.id("")).getText(); // for information on the page
        System.out.println(info);

        FileInputStream fis = new FileInputStream("");
        HSSFWorkbook wb = new HSSFWorkbook(fis);
        HSSFSheet sheet = wb.getSheet("");

        for (int i = 1; i <= sheet.getLastRowNum(); i++) {

            String first = sheet.getRow(i).getCell(0).getStringCellValue();
            String first1 = sheet.getRow(i).getCell(1).getStringCellValue();
            String first2 = sheet.getRow(i).getCell(2).getStringCellValue();

            driver.findElement(By.id("")).click(); // click on enroll

            // radio button for student or employee
            WebElement a = driver.findElement(By.id(""));
            if (a.getText().equalsIgnoreCase("Student")) {
                driver.findElement(By.id("")).click(); // Student
                driver.findElement(By.id("")); // choose college
                driver.findElement(By.id("")); // chose year
            } else {
                driver.findElement(By.id("")).click(); // Employee
                driver.findElement(By.id("")).click(); // chose company
                driver.findElement(By.id("")).click(); // chose role
            }

            Select st = new Select(driver.findElement(By.id("")));
            st.selectByVisibleText(first);

            driver.findElement(By.id("")).sendKeys(first1);
            driver.findElement(By.id("")).sendKeys(first2);
            driver.findElement(By.id("")).click(); // click on register

            String mar = driver.findElement(By.id("")).getText();
            System.out.println(mar);

            sheet.getRow(i).createCell(3).setCellValue(mar);
        }

        FileOutputStream fos = new FileOutputStream("");
        wb.write(fos);
        wb.close();
    }
}