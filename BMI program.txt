--BMI--
package practice;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.List;
import java.util.concurrent.TimeUnit;

import org.apache.commons.io.FileUtils;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

public class IVS_QP1 {

    WebDriver driver;

    @BeforeClass
    public void setup() {
        System.setProperty("", "");
        driver = new FirefoxDriver();
        driver.get("");
        driver.manage().window().maximize();
        driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);
    }

    @Test(priority = 1, dataProvider = "Weightheight")
    public void test1(int val1, int val2) throws Exception {

        WebDriverWait wait = new WebDriverWait(driver, 20);
        wait.until(ExpectedConditions.visibilityOfElementLocated(By.id("")));

        driver.findElement(By.id("")).click(); // click BMI calculator
        driver.findElement(By.id("")).sendKeys(String.valueOf(val1));
        driver.findElement(By.id("")).sendKeys(String.valueOf(val2));
        driver.findElement(By.id("")).click(); // calculate BMI

        File src = ((TakesScreenshot) driver).getScreenshotAs(OutputType.FILE);
        FileUtils.copyFile(src,
                new File("" + "Screenshot_BMI_" + val1 + "_" + val2 + ".png"));

        driver.findElement(By.id("")).click(); // for Reset
    }

    @DataProvider(name = "Weightheight")
    public Object[][] Weightheight() {

        Object[][] wtht = new Object[3][2];
        wtht[0][0] = 170;
        wtht[0][1] = 65;
        wtht[1][0] = 165;
        wtht[1][1] = 70;
        wtht[2][0] = 180;
        wtht[2][1] = 85;

        return wtht;
    }

    @Test(priority = 3)
    public void test2() {

        driver.findElement(By.id("")).click(); // calorie chart
        driver.findElement(By.id("")).click(); // vegetarian food items

        WebElement table = driver.findElement(By.id(""));
        List<WebElement> rows = table.findElements(By.tagName("tr"));
        System.out.println(rows.size());

        for (int i = 0; i < rows.size(); i++) {
            List<WebElement> cols = rows.get(i).findElements(By.tagName("td"));
            if (Integer.parseInt(cols.get(2).getText()) <= 111) {
                System.out.println(cols.get(1).getText());
            }
        }
    }

    @Test(priority = 2)
    public void test3() throws IOException {

        driver.findElement(By.id("")).click(); // Calorie Calculator

        FileInputStream fis = new FileInputStream("");
        XSSFWorkbook wb = new XSSFWorkbook(fis);
        XSSFSheet sheet = wb.getSheet("");

        for (int i = 1; i <= sheet.getLastRowNum(); i++) {

            String first = sheet.getRow(i).getCell(0).getStringCellValue();
            int first1 = (int) sheet.getRow(i).getCell(1).getNumericCellValue();
            long first2 = (long) sheet.getRow(i).getCell(2).getNumericCellValue();

            driver.findElement(By.id("")).sendKeys(first);

            Select s = new Select(driver.findElement(By.id("")));
            s.selectByVisibleText(String.valueOf(first1));

            WebElement st = driver.findElement(By.id(""));
            Select sl = new Select(st);
            sl.selectByVisibleText(String.valueOf(first2));

            driver.findElement(By.id("")).click(); // Calculate click

            String msg = driver.switchTo().alert().getText();
            driver.switchTo().alert().accept();
            System.out.println(msg);

            String mg = driver.findElement(By.id("")).getText();
            System.out.println(mg);

            sheet.getRow(i).createCell(3).setCellValue(mg);
            sheet.getRow(i).createCell(4).setCellValue(msg);
        }

        FileOutputStream fos = new FileOutputStream("");
        wb.write(fos);
        wb.close();
    }

    @AfterClass
    public void teardown() {
        driver.close();
    }
}